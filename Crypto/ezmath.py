from Crypto.Util.number import *
from secret import flag

m1=bytes_to_long(flag[:len(flag)//2])
m2=bytes_to_long(flag[len(flag)//2:])


p=getPrime(512)
q=getPrime(512)
n=p*q**2
e=65537
c=pow(m1,e,n)
print(n)
print(c)


Q=getPrime(512)
R=getPrime(512)
N=p*Q*R
print(N)
N=N//p
d=getPrime(int(N.bit_length()*0.26))
E=inverse(d,(Q-1)*(R-1))
C=pow(m2,E,N)
print(E)
print(C)

'''
1482612457605548840847898097499987174185939809934126523061110644416700337574477625111385202745079415040152186206366342316448372483266612527963770984659032706959872811421949606093036202097544826675551766085367759637439461202878925600364613124035696600969698721873020090688927518850845028225628573609389752106555484512252255975322206983780560205460785534629772318502272233406599400289968971547616334412433846193520438845037549165600208218308511491696482896667961739
484531715720636465186855115075171854647495128089314289909956611450704873118916451356975895866045729347752623059463987265992168264238579220083880779048143737545803083130458036748962283031078527647965921437328778756940710481460919615379777971215135338074376187057016009143347742314083490677382307655306647154242360784311609632762321131994203724294187436709891391318275377764317214977207680616423461392326745373362468179739570955513186948383894989691185589759076145
1405325174900813801416340830449304141833230710700882761247216724404217791273842196296918252833624099808373203372816880482653271585933970585622979996513156861652030092440552966395129988801909058448787172152460870707867501227203592580079170813856109455423137410563144211772824786449424833870577305949856066219513962659191113225326052175242228508642469686355870297498696356826654301506014770280070913449028581602469893798021451890792179582695424051955320356520718101
65156984425443747522207605855572790086836291293341642672342718145828118877085962824746036176810576864030808062595086036856265277682722973142877451802241694455737122707764455012457828648327965872670128109382781829083468123034838183471984874368687398079831054100668219587413429304695284976117753262658793464115
10979597025130377035795035356892004749563631954132262067568091653012983585212744415706041489456209695293862087199243484261358029551332196945909530096463624698785676239022292660464768747378352987456980876466006161420363892864500619880773467116659391621413608581963957512443227191770018406025159804796492220142
'''

